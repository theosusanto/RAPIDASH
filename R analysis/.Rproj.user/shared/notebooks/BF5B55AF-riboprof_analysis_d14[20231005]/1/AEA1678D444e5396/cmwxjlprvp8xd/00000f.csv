"0","# only the RPF samples on their own"
"0",""
"0","counts_rfp = counts[,samples$RFP_or_RNA=='RFP']"
"0","samples_rfp = samples[samples$RFP_or_RNA=='RFP',]"
"0","group_rfp = samples_rfp$grouping"
"0",""
"0","data_rfp = DGEList(counts = counts_rfp, samples = samples_rfp, group = group_rfp)"
"0",""
"0","# filter out low-expressed genes"
"0","# try min.count = 10 (gene has to be expressed above 10 counts in a 'meaningful' number of samples)"
"0","# ^^ min.count = 10 is actually the default, I believe"
"0",""
"0","# I think 'meaningful' is defined by the group attribute of data_rna"
"0",""
"0","# the edgeR User's Guide mentions this should be performed on normalized counts,"
"0","# but in all the examples it's done before TMM normalization..."
"0",""
"0","# going to generate a cpm version of data_rna and use that for determining which genes to keep."
"0",""
"0","data_rfp_cpm <- cpm(data_rfp, log=FALSE)"
"0","head(data_rfp_cpm)"
"1","                                       "
"1"," wt_rep1_RFP"
"1"," wt_rep2_RFP"
"1"," wt_rep3_RFP"
"1"," Nterm_rep1_RFP"
"1","
CSMD3_ENSG00000164796_ENST00000297405  "
"1","    8.189993"
"1","    8.921168"
"1","    8.288095"
"1","       8.264002"
"1","
LRRC20_ENSG00000172731_ENST00000446961 "
"1","   16.379986"
"1","   20.057246"
"1","   21.476978"
"1","      18.514542"
"1","
OR2W1_ENSG00000204704_ENST00000377175  "
"1","    0.000000"
"1","    0.000000"
"1","    0.000000"
"1","       0.000000"
"1","
HORMAD2_ENSG00000176635_ENST00000336726"
"1","    0.000000"
"1","    0.000000"
"1","    0.000000"
"1","       0.000000"
"1","
ASTL_ENSG00000188886_ENST00000342380   "
"1","    0.000000"
"1","    0.000000"
"1","    0.000000"
"1","       0.000000"
"1","
KCTD3_ENSG00000136636_ENST00000259154  "
"1","   66.591533"
"1","   66.939519"
"1","   58.016667"
"1","      57.132859"
"1","
"
"1","                                       "
"1"," Nterm_rep2_RFP"
"1"," Nterm_rep3_RFP"
"1","
CSMD3_ENSG00000164796_ENST00000297405  "
"1","    10.57966604"
"1","       12.73072"
"1","
LRRC20_ENSG00000172731_ENST00000446961 "
"1","    16.40614878"
"1","       21.15156"
"1","
OR2W1_ENSG00000204704_ENST00000377175  "
"1","     0.00000000"
"1","        0.00000"
"1","
HORMAD2_ENSG00000176635_ENST00000336726"
"1","     0.00000000"
"1","        0.00000"
"1","
ASTL_ENSG00000188886_ENST00000342380   "
"1","     0.07666425"
"1","        0.00000"
"1","
KCTD3_ENSG00000136636_ENST00000259154  "
"1","    57.72817771"
"1","       54.83493"
"1","
"
"0","# generate the vector for which genes to keep"
"0",""
"0","# if you don't want to use the filterByExpr function, can write your own"
"0","# criteria for which genes to keep"
"0",""
"0","keep_cpm = filterByExpr(data_rfp_cpm, min.count=10, group = data_rfp$samples$group)"
"0","table(keep_cpm)"
"1","keep_cpm
"
"1","FALSE "
"1"," TRUE "
"1","
"
"1"," 9614 "
"1","10263 "
"1","
"
