"0","# all_fc_sig$entrez <- mapIds(org.Hs.eg.db, keys=all_fc_sig$geneID, column=""ENTREZID"", keytype=""ENSEMBL"", multiVals=""first"")"
"0","# "
"0","# gmt_file <- ""./data/Human_GOBP_AllPathways_no_GO_iea_October_01_2023_entrezgene.gmt"""
"0","# genesets <- GSA.read.gmt(gmt_file)"
"0","# names(genesets$genesets) <- genesets$geneset.names"
"0","# genesets_filtered <- ids2indices(genesets$genesets,id=all_fc_sig$entrez, remove.empty=TRUE)"
"0","# geneset_sizes <- unlist(lapply(genesets_filtered, length))"
"0","# geneset_indices <- which(geneset_sizes>=10 & geneset_sizes<500)"
"0","# "
"0","# # v_rfp$E <- backup_v_rfp_E"
"0","# camera_results <- camera(v_rfp, genesets_filtered[geneset_indices], design_rfp, contrast=rfp_de[,1])"
"0","# # camera_results <- camera(v_te, genesets_filtered[geneset_indices], design_all, contrast=diff_te[,1])"
"0","# camera_descr <- unlist(lapply(rownames(camera_results), function(x){unlist(strsplit(x,""\\%""))[1]}))"
"0","# camera_Phenotype <- unlist(lapply(camera_results[,""Direction""], function(x){if(x==""Up""){1}else{(-1)}}))"
"0","# camera_genes <- c()"
"0","# "
"0","# # camera_results_file <- paste(""camera"", ""_"", ""v_rfp_d14"","
"0","# #                              ""_"", ""Human_GOBP_AllPathways_no_GO_iea_October_01_2023_entrezgene"", "".txt"", sep="""")"
"0","# camera_results_file <- paste(""camera"", ""_"", ""v_rfp_d14_nona_removeRNA"","
"0","#                              ""_"", ""Human_GOBP_AllPathways_no_GO_iea_October_01_2023_entrezgene"", "".txt"", sep="""")"
"0","# "
"0","# # camera_results_file <- paste(""camera"", ""_"", ""v_te_d14"", "
"0","# #                              ""_"", ""Human_GOBP_AllPathways_no_GO_iea_October_01_2023_entrezgene"", "".txt"", sep="""")"
"0","# "
"0","# "
"0","# for(j in 1:length(rownames(camera_results))){"
"0","#   current_geneset <- unlist(genesets_filtered[which(names(genesets_filtered) %in% "
"0","#                                                       rownames(camera_results)[j])])"
"0","#   current_genes <- c()"
"0","#   for(k in 1:length(current_geneset)){"
"0","#     if(k==length(current_geneset)){"
"0","#       current_genes <- paste(current_genes, all_fc_sig$entrez[current_geneset[k]], sep="""")"
"0","#     }else{"
"0","#       current_genes <- paste(current_genes, all_fc_sig$entrez[current_geneset[k]], "","", sep="""")"
"0","#     }"
"0","#   }"
"0","#   camera_genes <- rbind(camera_genes, current_genes)"
"0","# }"
"0","# "
"0","# rownames(camera_genes) <- rownames(camera_results)"
"0","# camera_results_generic_em <- data.frame(rownames(camera_results),"
"0","#                                         camera_descr,"
"0","#                                         PValue = camera_results[,""PValue""],"
"0","#                                         FDR=camera_results[,""FDR""],"
"0","#                                         camera_Phenotype,"
"0","#                                         camera_genes)"
"0","# # write.table(camera_results_generic_em, camera_results_file, col.name=TRUE, sep=""\t"", row.names=FALSE, quote=FALSE)"
"0","# "
"0","# camera_results_generic_em_nona <- na.omit(camera_results_generic_em)"
"0","# write.table(camera_results_generic_em_nona, camera_results_file, col.name=TRUE, sep=""\t"", row.names=FALSE, quote=FALSE)"
"0","# "
"0",""
