"0","# generate a table of all kept genes as ranked by p-value"
"0","ranked_genes = topTable(e_rna_fit, coef=1, number=sum(keep_cpm), sort.by='p')"
"0",""
"0","# volcano plot"
"0","ranked_genes$neglog10p = -log(ranked_genes$adj.P.Val, 10)"
"0","ranked_genes$plot_fill = rep('black', nrow(ranked_genes))"
"0","ranked_genes[ranked_genes$logFC > 0.25 & ranked_genes$adj.P.Val < 0.05,'plot_fill'] = 'purple'"
"0","ranked_genes[ranked_genes$logFC < -0.25 & ranked_genes$adj.P.Val < 0.05,'plot_fill'] = 'magenta'"
"0",""
"0","pal = c('black', 'magenta', 'purple')"
"0",""
"0","ranked_genes$plot_fill = factor(ranked_genes$plot_fill, levels = pal)"
"0",""
"0","options(repr.plot.width=4, repr.plot.height=4)"
"0",""
"0","ggplot(data=ranked_genes, aes(x=logFC, y=neglog10p, color=plot_fill)) + "
"0","  geom_point() + "
"0","  scale_color_manual(values=pal) + "
"0","  theme_classic() + "
"0","  theme(legend.position='none')"
"0",""
