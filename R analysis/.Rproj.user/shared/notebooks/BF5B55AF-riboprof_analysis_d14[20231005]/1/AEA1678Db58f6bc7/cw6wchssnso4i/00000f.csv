"0","# volcano plot"
"0","top_te_genes = topTable(e_te_fit, coef=1, number=sum(keep_all_cpm), sort.by='p')"
"0",""
"0","top_te_genes$neglog2p = -log(top_te_genes$adj.P.Val, 2)"
"0","top_te_genes$plot_fill = rep('black', nrow(top_te_genes))"
"0","top_te_genes[top_te_genes$logFC > 0.25 & top_te_genes$adj.P.Val < 0.05,'plot_fill'] = 'purple'"
"0","top_te_genes[top_te_genes$logFC < -0.25 & top_te_genes$adj.P.Val < 0.05,'plot_fill'] = 'magenta'"
"0",""
"0","pal = c('black', 'magenta', 'purple')"
"0",""
"0","top_te_genes$plot_fill = factor(top_te_genes$plot_fill, levels = pal)"
"0",""
"0","options(repr.plot.width=4, repr.plot.height=4)"
"0",""
"0","ggplot(data=top_te_genes, "
"0","       aes(x=logFC, y=neglog2p, color=plot_fill)) + "
"0","geom_point() + "
"0","scale_color_manual(values=pal) + "
"0","theme_classic() + "
"0","theme(legend.position='none')"
