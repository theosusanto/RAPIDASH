"0","# our goal here is very similar to the example in the edgeR User's guide in section 3.5,"
"0","# 'Comparisons both between and within subjects'. The analogies are:"
"0","# Healthy/Disease1/Disease2 ~ S27>S27L, S27L>S27, and Unedited"
"0","# each patient ~ each replicate (note that in the example, they re-number their patients"
"0","# such that they have a patient #1, #2, and #3 in each disease)"
"0","# Treatment (hormone or none) (w/ a pair of treated/untreated samples for each patient) ~ RPF vs RNA "
"0",""
"0","# In the example they don't include the '0' so it's just ~Disease; I think it's more"
"0","# intuitive to include the 0 so it's explicitly clear what baseline is being subtracted"
"0","# however this only seems to solve this for the line variable, not lane or fraction..."
"0","# "
"0",""
"0","# line = factor(data_all$samples$genotype, levels=c('wt', 'Nterm'))"
"0","# fraction = factor(data_all$samples$RFP_or_RNA, levels=c('RNA', 'RFP'))"
"0","# "
"0","# design_all = model.matrix(~0+line+fraction:line, data=data_all$samples)"
"0","# colnames(design_all) = gsub(':', '_', colnames(design_all))"
"0","# design_all"
"0",""
"0","# make contrasts"
"0","# diff_te = makeContrasts(lineNterm_fractionRFP-linewt_fractionRFP,"
"0","#                         levels=colnames(design_all))"
"0","# "
"0","# diff_te"
"0",""
"0","line = factor(data_all$samples$genotype, levels=c('wt', 'Nterm'))"
"0","fraction = factor(data_all$samples$RFP_or_RNA, levels=c('RNA', 'RFP'))"
"0",""
"0","design_all = model.matrix(~0+line:fraction, data=data_all$samples)"
"0","colnames(design_all) = gsub(':', '_', colnames(design_all))"
"0","design_all"
"1","              "
"1"," linewt_fractionRNA"
"1"," lineNterm_fractionRNA"
"1"," linewt_fractionRFP"
"1"," lineNterm_fractionRFP"
"1","
wt_rep1_RFP   "
"1","                  0"
"1","                     0"
"1","                  1"
"1","                     0"
"1","
wt_rep2_RFP   "
"1","                  0"
"1","                     0"
"1","                  1"
"1","                     0"
"1","
wt_rep3_RFP   "
"1","                  0"
"1","                     0"
"1","                  1"
"1","                     0"
"1","
Nterm_rep1_RFP"
"1","                  0"
"1","                     0"
"1","                  0"
"1","                     1"
"1","
Nterm_rep2_RFP"
"1","                  0"
"1","                     0"
"1","                  0"
"1","                     1"
"1","
Nterm_rep3_RFP"
"1","                  0"
"1","                     0"
"1","                  0"
"1","                     1"
"1","
wt_rep1_RNA   "
"1","                  1"
"1","                     0"
"1","                  0"
"1","                     0"
"1","
Nterm_rep2_RNA"
"1","                  0"
"1","                     1"
"1","                  0"
"1","                     0"
"1","
wt_rep2_RNA   "
"1","                  1"
"1","                     0"
"1","                  0"
"1","                     0"
"1","
wt_rep3_RNA   "
"1","                  1"
"1","                     0"
"1","                  0"
"1","                     0"
"1","
Nterm_rep1_RNA"
"1","                  0"
"1","                     1"
"1","                  0"
"1","                     0"
"1","
Nterm_rep3_RNA"
"1","                  0"
"1","                     1"
"1","                  0"
"1","                     0"
"1","
"
"1","attr(,""assign"")"
"1","
"
"1","[1]"
"1"," 1"
"1"," 1"
"1"," 1"
"1"," 1"
"1","
"
"1","attr(,""contrasts"")"
"1","
"
"1","attr(,""contrasts"")$line
"
"1","[1]"
"1"," ""contr.treatment"""
"1","
"
"1","
"
"1","attr(,""contrasts"")$fraction
"
"1","[1]"
"1"," ""contr.treatment"""
"1","
"
"1","
"
"0","diff_te = makeContrasts("
"0","    Nterm_TE_vs_wt_TE = (lineNterm_fractionRFP-lineNterm_fractionRNA)-(linewt_fractionRFP-linewt_fractionRNA),"
"0","                         levels=colnames(design_all))"
"0","diff_te"
"1","                       Contrasts
"
"1","Levels                 "
"1"," Nterm_TE_vs_wt_TE"
"1","
  linewt_fractionRNA   "
"1","                 1"
"1","
  lineNterm_fractionRNA"
"1","                -1"
"1","
  linewt_fractionRFP   "
"1","                -1"
"1","
  lineNterm_fractionRFP"
"1","                 1"
"1","
"
