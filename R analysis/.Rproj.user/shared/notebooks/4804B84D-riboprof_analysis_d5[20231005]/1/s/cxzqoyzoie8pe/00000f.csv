"0","# only the RPF samples on their own"
"0",""
"0","counts_rfp = counts[,samples$RFP_or_RNA=='RFP']"
"0","samples_rfp = samples[samples$RFP_or_RNA=='RFP',]"
"0","group_rfp = samples_rfp$grouping"
"0",""
"0","data_rfp = DGEList(counts = counts_rfp, samples = samples_rfp, group = group_rfp)"
"0",""
"0","# filter out low-expressed genes"
"0","# try min.count = 10 (gene has to be expressed above 10 counts in a 'meaningful' number of samples)"
"0","# ^^ min.count = 10 is actually the default, I believe"
"0",""
"0","# I think 'meaningful' is defined by the group attribute of data_rna"
"0",""
"0","# the edgeR User's Guide mentions this should be performed on normalized counts,"
"0","# but in all the examples it's done before TMM normalization..."
"0",""
"0","# going to generate a cpm version of data_rna and use that for determining which genes to keep."
"0",""
"0","data_rfp_cpm <- cpm(data_rfp, log=FALSE)"
"0","head(data_rfp_cpm)"
"1","                       "
"1"," wt_rep1_RFP"
"1"," wt_rep2_RFP"
"1"," wt_rep3_RFP"
"1"," Nterm_rep1_RFP"
"1"," Nterm_rep2_RFP"
"1"," Nterm_rep3_RFP"
"1","
SLC41A2_ENST00000258538"
"1","  13.3825502"
"1","  14.0917368"
"1","  11.8030010"
"1","      9.6758151"
"1","     11.2953402"
"1","     13.9493619"
"1","
PFN4_ENST00000313213   "
"1","   0.0000000"
"1","   0.0000000"
"1","   0.0000000"
"1","      0.1668244"
"1","      0.1568797"
"1","      0.1765742"
"1","
NAALAD2_ENST00000534061"
"1","   5.6618482"
"1","   3.7577965"
"1","   4.4821523"
"1","      4.0037856"
"1","      2.3531959"
"1","      3.6197711"
"1","
PARN_ENST00000437198   "
"1","  53.2728442"
"1","  48.0997950"
"1","  46.6143839"
"1","     44.5421146"
"1","     45.0244811"
"1","     57.2983282"
"1","
KLHL36_ENST00000564996 "
"1","   7.9780588"
"1","  10.1460505"
"1","  10.9065706"
"1","     13.3459519"
"1","     11.1384605"
"1","     12.0070457"
"1","
IL34_ENST00000288098   "
"1","   0.2573567"
"1","   0.1878898"
"1","   0.1494051"
"1","      0.3336488"
"1","      0.3137595"
"1","      0.1765742"
"1","
"
"0","# generate the vector for which genes to keep"
"0",""
"0","# if you don't want to use the filterByExpr function, can write your own"
"0","# criteria for which genes to keep"
"0",""
"0","keep_cpm = filterByExpr(data_rfp_cpm, min.count=10, group = data_rfp$samples$group)"
"0","table(keep_cpm)"
"1","keep_cpm
"
"1","FALSE "
"1"," TRUE "
"1","
"
"1"," 9915 "
"1"," 9365 "
"1","
"
