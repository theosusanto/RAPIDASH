"0","# create a DGE data object for all RNA and RPF samples"
"0",""
"0","data_all = DGEList(counts = counts, samples = samples, group = samples$grouping)"
"0",""
"0","# filter out low-expressed genes"
"0",""
"0","# when calculating TE, Gerald filters by genes that are expressed at CPM > 1 in at least a min"
"0","# number of RPF libraries, b/c his RPF libraries have fewer reads...my RPF and RNA libraries are"
"0","# pretty similar in size..."
"0",""
"0","# try min.count = 10 (gene has to be expressed above 10 counts in a 'meaningful' number of samples)"
"0","# ^^ min.count = 10 is actually the default, I believe"
"0",""
"0","# I think 'meaningful' is defined by the group attribute of data_rna"
"0",""
"0","# the edgeR User's Guide mentions this should be performed on normalized counts,"
"0","# but in all the examples it's done before TMM normalization..."
"0",""
"0","# going to generate a cpm version of data_rna and use that for determining which genes to keep."
"0",""
"0","data_all_cpm <- cpm(data_all, log=FALSE)"
"0",""
"0","# generate the vector for which genes to keep"
"0",""
"0","keep_all_cpm = filterByExpr(data_all_cpm, min.count=10, data_all$samples$group)"
"0","table(keep_all_cpm)"
"1","keep_all_cpm
"
"1","FALSE "
"1"," TRUE "
"1","
"
"1"," 9374 "
"1"," 9906 "
"1","
"
